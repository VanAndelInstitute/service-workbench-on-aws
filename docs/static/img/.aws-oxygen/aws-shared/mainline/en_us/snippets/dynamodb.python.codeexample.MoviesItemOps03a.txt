from decimal import Decimal
from pprint import pprint
import boto3


def update_movie(title, year, rating, plot, actors, dynamodb=None):
    if not dynamodb:
        dynamodb = boto3.resource('dynamodb', endpoint_url="http://localhost:8000")

    table = dynamodb.Table('Movies')

    resp = table.get_item(Key={'year': year, 'title': title})
    item = resp['Item']
    item['info']['rating'] = Decimal(rating)
    item['info']['plot'] = plot
    item['info']['actors'] = actors

    table.put_item(Item=item)
    return table.get_item(Key={'year': year, 'title': title})['Item']


if __name__ == '__main__':
    movie = update_movie(
        "The Big New Movie", 2015, 5.5, "Everything happens all at once.",
        ["Larry", "Moe", "Curly"])
    print("Update movie succeeded:")
    pprint(movie, sort_dicts=False)
